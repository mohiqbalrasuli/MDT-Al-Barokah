<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PMB MDT Al-Barokah</title>
    <link rel="shortcut icon" href="./asset/img/logo.png" type="image/x-icon" />
    <!-- Bootstrap CSS -->
    <link href="asset/css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="asset/css/pmb.css" />
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-custom fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#home">
                <img src="asset/img/logo.png" alt="Logo MDT Albarokah" class="logo" width="50px" height="50px" />
                <div>
                    <span class="d-block">MDT Al-Barokah</span>
                    <span class="d-block yayasan">Yayasan Nurur Roziqi</span>
                </div>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="pmb.html#home">Beranda</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="pmb.html#about">Info PMB</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="pmb.html#contact">Kontak</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="hero-content">
                        <h1>Penerimaan Murid Baru</h1>
                        <h3>MDT Al-Barokah</h3>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Info PMB Section -->
    <section id="info" class="info-section">
        <div class="container">
            <div class="section-title">
                <h2>Formulir Pendaftaran Murid Baru</h2>
                <p>Lengkapi Data Di bawah ini</p>
            </div>
            <div class="row justify-content-center">
                <div class="col-md-12">
                    <div class="info-card">
                        <div class="mb-3">
                            <h4>Data Murid</h4>
                        </div>
                        <form id="form-pendaftaran">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="nama_murid" class="form-label">Nama Lengkap</label>
                                    <input required type="text" class="form-control" id="nama_murid"
                                        name="nama_murid" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="jenis_kelamin" class="form-label">Jenis Kelamin</label>
                                    <select class="form-select" id="jenis_kelamin" name="jenis_kelamin" required>
                                        <option value="">-- Pilih --</option>
                                        <option value="Laki-laki">Laki-laki</option>
                                        <option value="Perempuan">Perempuan</option>
                                    </select>
                                </div>
                            </div>

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="tempat_lahir" class="form-label">Tempat Lahir</label>
                                    <input required type="text" class="form-control" id="tempat_lahir"
                                        name="tempat_lahir" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="tanggal_lahir" class="form-label">Tanggal Lahir</label>
                                    <input required type="date" class="form-control" id="tanggal_lahir"
                                        name="tanggal_lahir" required>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="alamat" class="form-label">Alamat Lengkap</label>
                                <textarea class="form-control" id="alamat" name="alamat" rows="3" required></textarea>
                            </div>

                            <div class="mb-4">
                                <label for="foto_murid" class="form-label">Upload Foto_murid</label>
                                <input required class="form-control" type="file" id="foto_murid"
                                    name="foto_murid" accept="image/*">
                                <div class="invalid-feedback">Format Nama File : foto_Nama Murid</div>
                            </div>
                            <div class="mb-4">
                                <label for="foto_akta" class="form-label">Upload Akta Kelahiran</label>
                                <input required class="form-control" type="file" id="foto_akta" name="foto_akta"
                                    accept="image/*">
                                <div class="invalid-feedback">Format Nama File : Akta_Nama Murid</div>
                            </div>
                            <div class="mb-4">
                                <label for="foto_kk" class="form-label">Upload Kartu Keluarga</label>
                                <input required class="form-control" type="file" id="foto_kk" name="foto_kk"
                                    accept="image/*">
                                <div class="invalid-feedback">Format Nama File : KK_Nama Murid</div>
                            </div>

                            <!-- Data Orang Tua -->
                            <div class="mb-3 pt-5">
                                <h4>Data Orang Tua</h4>
                            </div>

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="nama_ayah" class="form-label">Nama Ayah</label>
                                    <input required type="text" class="form-control" id="nama_ayah"
                                        name="nama_ayah" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="pekerjaan_ayah" class="form-label">Pekerjaan Ayah</label>
                                    <input required type="text" class="form-control" id="pekerjaan_ayah"
                                        name="pekerjaan_ayah">
                                </div>
                            </div>

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="nama_ibu" class="form-label">Nama Ibu</label>
                                    <input required type="text" class="form-control" id="nama_ibu"
                                        name="nama_ibu" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="pekerjaan_ibu" class="form-label">Pekerjaan Ibu</label>
                                    <input required type="text" class="form-control" id="pekerjaan_ibu"
                                        name="pekerjaan_ibu">
                                </div>
                            </div>

                            <div class="mb-4">
                                <label for="no_hp_ortu" class="form-label">Nomor HP Orang Tua</label>
                                <input required type="tel" class="form-control" id="no_hp_ortu"
                                    name="no_hp_ortu" required>
                            </div>

                            <!-- Tombol Submit -->
                            <div class="text-end">
                                <button type="submit" class="btn btn-success">Kirim Pendaftaran</button>
                                <button type="reset" class="btn btn-secondary">Reset</button>
                            </div>
                        </form>
                        <script>
                            async function encodeFileToBase64(file) {
                                return new Promise((resolve, reject) => {
                                    const reader = new FileReader();
                                    reader.onload = () => resolve(reader.result.split(",")[1]); // Hilangkan header base64
                                    reader.onerror = reject;
                                    reader.readAsDataURL(file);
                                });
                            }
                            document.querySelector("form").addEventListener("submit", async function(e) {
                                e.preventDefault();

                                const form = e.target;
                                const fotoMurid = form.foto_murid.files[0];
                                const fotoAkta = form.foto_akta.files[0];
                                const fotoKK = form.foto_kk.files[0];

                                const [encodedFoto, encodedAkta, encodedKK] = await Promise.all([
                                    encodeFileToBase64(fotoMurid),
                                    encodeFileToBase64(fotoAkta),
                                    encodeFileToBase64(fotoKK),
                                ]);

                                const formData = new URLSearchParams();
                                formData.append("nama_murid", form.nama_murid.value);
                                formData.append("jenis_kelamin", form.jenis_kelamin.value);
                                formData.append("tempat_lahir", form.tempat_lahir.value);
                                formData.append("tanggal_lahir", form.tanggal_lahir.value);
                                formData.append("alamat", form.alamat.value);
                                formData.append("nama_ayah", form.nama_ayah.value);
                                formData.append("pekerjaan_ayah", form.pekerjaan_ayah.value);
                                formData.append("nama_ibu", form.nama_ibu.value);
                                formData.append("pekerjaan_ibu", form.pekerjaan_ibu.value);
                                formData.append("no_hp_ortu", form.no_hp_ortu.value);
                                formData.append("foto_murid", encodedFoto);
                                formData.append("foto_akta", encodedAkta);
                                formData.append("foto_kk", encodedKK);

                                try {
                                    const response = await fetch(
                                        "https://script.google.com/macros/s/AKfycbxTimIum6qkaL7zCvZ97XGTqDljnruYSd6EfBCO1wi-y-jki0t7f5vCXvdHW675TyFD/exec", {
                                            method: "POST",
                                            body: formData,
                                        }
                                    );

                                    const text = await response.text();
                                    if (text.includes("Sukses")) {
                                        alert("Pendaftaran berhasil dikirim!");
                                        form.reset();
                                    } else {
                                        alert("Gagal: " + text);
                                    }
                                } catch (error) {
                                    console.error(error);
                                    alert("Terjadi kesalahan saat mengirim.");
                                }
                            });
                        </script>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <h5>Madrasah Diniyah Takmiliyah Al-Barokah</h5>
                    <p>
                        Lembaga pendidikan Islam yang berkomitmen mencetak generasi Qurani
                        berakhlak mulia dan berkarakter islami.
                    </p>
                    <div class="social-icons">
                        <a href="https://www.facebook.com/share/1BXrPEgjAE/" class="social-icon">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://wa.me/6287871444469" class="social-icon">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                    </div>
                </div>
                <div class="col-lg-4 mb-4">
                    <h5>Menu</h5>
                    <ul class="footer-links">
                        <li><a href="pmb.html#home">Beranda</a></li>
                        <li><a href="pmb.html#info">Info PMB</a></li>
                        <li><a href="pmb.html#contact">Kontak</a></li>
                    </ul>
                </div>
                <div class="col-lg-4 mb-4">
                    <h5>Kontak Info</h5>
                    <ul class="footer-links">
                        <li>
                            <i class="fas fa-map-marker-alt me-2"></i>
                            Jl. Arya Wiraraja Batuputih Laok Batuputih Sumenep
                        </li>
                        <li>
                            <i class="fas fa-phone me-2"></i>
                            +62 878 7144 4469
                        </li>
                        <li>
                            <i class="fas fa-envelope me-2"></i>
                            mdtalbarokahbalok@gmail.com
                        </li>
                        <li>
                            <i class="fas fa-globe me-2"></i>
                            www.mdtalbarokah.sch.id
                        </li>
                    </ul>
                </div>
            </div>
            <hr class="my-4" style="border-color: #34495e" />
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-0">
                        &copy; 2024 Madrasah Diniyah Taklimiyah Albarokah. All rights
                        reserved.
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="mb-0">
                        Designed by
                        <a href="https://moh-iqbal-rasuli.netlify.app/" target="_blank"
                            class="text-decoration-none text-light">Moh. Iqbal rasuli</a>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="asset/js/boostrap/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="asset/js/script.js"></script>
</body>

</html>
